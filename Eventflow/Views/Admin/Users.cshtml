@using Eventflow.ViewModels.Admin.Component
@model ManageUsersViewModel

@{
    ViewData["Title"] = "Manage Users";
    Layout = "~/Views/Shared/_CalendarLayout.cshtml";
}

<h1 class="mb-4">Manage Users</h1>

<form id="userFilterForm" method="get" class="row g-3 mb-4 align-items-end">
    <div class="col-md-4">
        <label for="search" class="form-label">Search</label>
        <input type="text" name="search" id="search" value="@Model.SearchTerm" class="form-control" placeholder="Username or email" />
    </div>
    <div class="col-md-3">
        <label for="role" class="form-label">Role</label>
        <select name="role" id="role" class="form-select">
            <option value="All" selected="@("All" == Model.SelectedRole)">All Roles</option>
            <option value="User" selected=@("User" == Model.SelectedRole)>User</option>
            <option value="Admin" selected=@("Admin" == Model.SelectedRole)>Admin</option>
        </select>
    </div>
    <div class="col-md-3">
        <label for="status" class="form-label">Status</label>
        <select name="status" id="status" class="form-select">
            <option value="All" selected=@("All" == Model.SelectedStatus)>All Statuses</option>
            <option value="Active" selected=@("Active" == Model.SelectedStatus)>Active</option>
            <option value="Banned" selected=@("Banned" == Model.SelectedStatus)>Banned</option>
        </select>
    </div>
    <div class="col-md-2">
        <button class="btn btn-primary w-100" type="submit">Filter</button>
    </div>
</form>

<div id="user-table-container" style="max-height: 500px; overflow-y: auto; border: 1px solid #dee2e6;">
    @Html.Partial("~/Views/Shared/Partials/Admin/User/_UserTablePartial.cshtml", Model)
</div>

<div class="modal fade" id="deleteUserModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content d-flex flex-column justify-content-between" style="min-height: 50px;">
        <div class="modal-header">
            <h5 class="modal-title">Confirm Deletion</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body d-flex flex-grow-1 justify-content-center align-items-center text-center">
            <p class="mb-0">
            Are you sure you want to delete <strong id="deleteUsername"></strong>?
            </p>
            <input type="hidden" id="deleteUserId" />
        </div>

        <div class="modal-footer justify-content-center gap-3">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
        </div>
        </div>
  </div>
</div>

@Html.Partial("~/Views/Shared/Partials/Admin/User/_EditUserModalPartial.cshtml")

<script src="~/js/admin/admin_manage_users.js"></script>